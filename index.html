<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ecologic</title>
    <link rel="stylesheet" href="./style/global.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <script
      src="https://code.jquery.com/jquery-3.7.1.slim.min.js"
      integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8="
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/gsap.min.js"></script>
  </head>
  <body>
    <div class="main_ctr">
      <nav class="nav_ctr">
        <div class="nav_box">
          <img src="./images/nav_logo.svg" class="nav_logo" alt="nav_logo" />
          <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">About</a></li>
            <li><a href="#">Services</a></li>
            <li><a href="#">Contact</a></li>
            <li>
              <img
                src="./images/nav_menu.svg"
                class="nav_menu"
                alt="nav_menu"
              />
            </li>
          </ul>
        </div>
      </nav>
      <div class="backdrop"></div>
      <div class="floating_card"></div>
      <!-- <div class="card_ctr">
        <div class="card">
          <div
            class="content"
            style="background: url('./images/bg_image_first.png')"
          ></div>
        </div>
        <div class="card">
          <div class="content" style="background: blue"></div>
        </div>
        <div class="card">
          <div class="content" style="background: green"></div>
        </div>
        <div class="card">
          <div class="content" style="background: greenyellow"></div>
        </div>
        <div class="card">
          <div class="content" style="background: bisque"></div>
        </div>
        <div class="card">
          <div class="content" style="background: blueviolet"></div>
        </div>
      </div> -->
    </div>
    <script>
      $(document).ready(function () {
        // Initialize the main functionality of the application
        const $mainCtr = $('.main_ctr');
        function init() {
          const arr = [
            {
              title: 'Card 1',
              content: 'Content for card 1',
              background: 'url(./images/circular_thinking.png)',
            },
            {
              title: 'Card 2',
              content: 'Content for card 1',
              background: 'url(./images/producing_pmu.png)',
            },
            {
              title: 'Card 3',
              content: 'Content for card 1',
              background: 'url(./images/bg_image_first.png)',
            },
            {
              title: 'Card 4',
              content: 'Content for card 1',
              background: 'url(./images/bg_image_first.png)',
            },
            {
              title: 'Card 5',
              content: 'Content for card 1',
              background: 'url(./images/bg_image_first.png)',
            },
            {
              title: 'Card 6',
              content: 'Content for card 1',
              background: 'url(./images/bg_image_first.png)',
            },
            {
              title: 'Card 7',
              content: 'Content for card 1',
              background: 'url(./images/bg_image_first.png)',
            },
          ];
          arr.forEach((item, idx) => {
            const $card = $(`
              <div class="card" style="position: absolute; top: 50%; left: calc(50% + ${
                idx * 320
              }px); transform: translateY(-50%); background: ${
              item.background
            } no-repeat center center; background-size: cover;">
                <div class="content">
                  <h2>${item.title}</h2>
                  <p>${item.content}</p>
                </div>
              </div>
            `);
            $mainCtr.append($card);
          });
        }

        // Call the init function when the document is ready
        init();

        $('.card').click(function () {
          const $card = $(this).find('.content');
          const $parent = $card.parent();
          console.log('parent:', $parent);
          const domCard = $card[0]; // or $card.get(0)
          const getBoundingRect = domCard.getBoundingClientRect();
          console.log(getBoundingRect);
          const $copyCard = $parent.clone();
          const bg = $parent.css('background');
          gsap.fromTo(
            '.floating_card',
            {
              position: 'absolute',
              left: getBoundingRect.left + 'px',
              top: getBoundingRect.top + 'px',
              width: getBoundingRect.width + 'px',
              height: getBoundingRect.height + 'px',
              background: bg,
              zIndex: 6,
            },
            {
              position: 'absolute',
              backgroundColor: bg,
              left: '0px',
              top: '0px',
              right: 'auto',
              bottom: 'auto',
              width: '100vw',
              height: '100vh',
              ease: 'power2.inOut',
              duration: 2,
              zIndex: 6,
              onStart: function () {
                // gsap.set($parent, {
                //   opacity: '0',
                // });
              },
              onComplete: function () {
                // gsap.to($parent, {
                //   width: '0px',
                //   height: '0px',
                //   opacity: 0,
                //   duration: 1,
                //   ease: 'power2.inOut',
                //   onComplete: function () {
                //     $parent.remove();
                //   },
                // });
              },
            }
          );
          gsap.fromTo(
            $parent,
            {
              minWidth: '300px',
              opacity: 1,
              ease: 'power2.inOut',
              zIndex: 5,
            },
            {
              width: '0px',
              minWidth: '0px',
              opacity: 0,
              duration: 1,
              padding: 0,
              ease: 'power2.inOut',
              zIndex: 5,
              onComplete: function () {
                setTimeout(() => {
                  $parent.remove();
                }, 200);
              },
            }
          );
          const $index = $('.card').index(this);
          console.log($index, 'index of card clicked');
          const $listCard = $('.card');
          console.log($listCard, $listCard.slice($index), 'list card');
          $listCard.slice($index).each(function (index) {
            const $this = $(this);
            gsap.to($this, {
              xPercent: -100,
              x: -20,
              delay: 0.2,
              duration: 0.5,
              ease: 'power2.inOut',
              stagger: 0.5,
            });
          });
        });
      });
    </script>
  </body>
</html>
